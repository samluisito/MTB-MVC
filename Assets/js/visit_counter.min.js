function sumarDias(a,b){a.setDate(a.getDate()+b);return a}function fechadehoy(){let a=new Date;return new Date(a.getFullYear(),a.getMonth(),a.getDate())}
function getVisitado(){let a=JSON.parse(sessionStorage.getItem("pagv"));if(a){let c=[],d="";for(var b=0;b<a.length;b++)a[b].page_title==document.title&&(d=a[b].fecha_visit),(new Date(a[b].fecha_visit)).valueOf()>fechadehoy().valueOf()&&c.push({page_title:a[b].page_title,fecha_visit:a[b].fecha_visit});return""===d?fechadehoy():new Date(d)}return fechadehoy()}
function idnav(){var a=localStorage.getItem("visid");a||fetch(base_url+"visitas/getUnicoId").then(a=>a.json()).then(b=>{a=b.id;localStorage.setItem("visid",a)});return a}
if(getVisitado().valueOf()<=fechadehoy().valueOf()){var registrarVisita=async function(){let a=base_url+"Visitas/registrar_visita",b={pagina:document.title,url:window.location.href,idnav:idnav()};await (await fetch(a,{method:"POST",body:JSON.stringify(b)})).json()&&setVisita()},setVisita=function(){if(sessionStorage.getItem("pagv")){let b=JSON.parse(sessionStorage.getItem("pagv")),c=[];if(sessionStorage.getItem("pagv").length)for(var a=0;a<b.length;a++)(new Date(b[a].fecha_visit)).valueOf()>fechadehoy().valueOf()&&
c.push({page_title:b[a].page_title,fecha_visit:b[a].fecha_visit});c.push({page_title:document.title,fecha_visit:sumarDias(fechadehoy(),1)});sessionStorage.setItem("pagv",JSON.stringify(c))}else a=[{page_title:document.title,fecha_visit:sumarDias(fechadehoy(),1)}],sessionStorage.setItem("pagv",JSON.stringify(a))};registrarVisita()};