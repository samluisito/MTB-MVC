let tableClientes="";document.addEventListener("DOMContentLoaded",function(){document.querySelector("#tableClientes")&&dataTablaClientes()},!1);
function setCliente(){let c=document.querySelector("#formCliente");c.onsubmit=function(b){b.preventDefault();b=document.querySelector("#txtIdentificacion").value;var a=document.querySelector("#txtNombre").value;let e=document.querySelector("#txtApellido").value,f=document.querySelector("#txtEmail").value,g=document.querySelector("#txtTelefono").value,h=document.querySelector("#txtNit").value;document.querySelector("#txtNombreFiscal");document.querySelector("#txtDirFiscal");if(""===b||""===a||""===
e||""===f||""===g||""===h)return Swal.fire("atencion","todos los campos son obligatorios.","error"),!1;let d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b=base_url+"Clientes/setCliente";a=new FormData(c);d.open("POST",b,!0);d.send(a);d.onreadystatechange=function(){if(4===d.readyState&&200===d.status){let a=JSON.parse(d.responseText);a.status?($("#modalFormCliente").modal("hide"),c.reset(),Swal.fire("Usuarios",a.msg,"success"),tableClientes.ajax.reload(null,!1)):
Swal.fire("Error",a.msg,"error")}}}}function ftnNvoCte(){document.getElementById("idUsuario").value="";document.querySelector(".modal-header").classList.replace("headerUpdate","headerRegister");document.getElementById("btnActionForm").classList.replace("btn-info","btn-primary");document.getElementById("btnText").innerHTML="Guardar";document.getElementById("titleModal").innerHTML="Nuevo Cliente";document.getElementById("formCliente").reset();$("#modalFormCliente").modal("show");setCliente()}
function fntEdit(c){document.getElementById("titleModal").innerHTML="Actualizar Cliente";document.querySelector(".modal-header").classList.replace("headerRegister","headerUpdate");document.getElementById("btnActionForm").classList.replace("btn-primary","btn-info");document.getElementById("btnText").innerHTML="Actualizar";let b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b.open("GET",base_url+"clientes/getCte/"+c,!0);b.send();b.onreadystatechange=function(){if(4===
b.readyState&&200===b.status){let a=JSON.parse(b.responseText);a.status?(document.getElementById("idUsuario").value=a.data.idpersona,document.getElementById("txtIdentificacion").value=a.data.identificacion,document.getElementById("txtNombre").value=a.data.nombres,document.getElementById("txtApellido").value=a.data.apellidos,document.getElementById("txtTelefono").value=a.data.telefono,document.getElementById("txtEmail").value=a.data.email_user,document.getElementById("txtNit").value=a.data.nit,document.getElementById("txtNombreFiscal").value=
a.data.nombrefiscal,document.getElementById("txtDirFiscal").value=a.data.direccionfiscal,$("#modalFormCliente").modal("show"),setCliente()):Swal.fire("Error",a.msg,"error")}}}
function dataTablaClientes(){tableClientes=$("#tableClientes").DataTable({destroy:!0,stateSave:!0,responsive:!0,search:!0,searching:!0,Processing:!0,info:!0,paging:!0,iDisplayLength:25,ordering:!0,order:[[0,"desc"]],language:{sProcessing:"Procesando...",sLengthMenu:"Mostrar _MENU_ registros",sZeroRecords:"No se encontraron resultados",sEmptyTable:"Ning\u00fan dato disponible en esta tabla",sInfo:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",sInfoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",
sInfoFiltered:"(filtrado de un total de _MAX_ registros)",sInfoPostFix:"",sSearch:"Buscar:",sUrl:"",sInfoThousands:",",sLoadingRecords:"Cargando...",oPaginate:{sFirst:"Primero",sLast:"\u00daltimo",sNext:"Siguiente",sPrevious:"Anterior"},oAria:{sSortAscending:": Actilet para ordenar la columna de manera ascendente",sSortDescending:": Actilet para ordenar la columna de manera descendente"},buttons:{copy:"Copiar",colvis:"Visibilidad"}},ajax:{url:base_url+"clientes/getClientes",dataSrc:""},columns:[{data:"idpersona",
visible:!1,searchable:!1,all:!0},{data:"identificacion"},{data:"nombres"},{data:"apellidos"},{data:"telefono"},{data:"email_user"},{data:"status",searchable:!1,all:!0},{data:"options",searchable:!1,all:!0}],dom:'<"row"<"col-sm-12 col-md-4"l><"col-sm-12 col-md-4"<"dt-buttons btn-group flex-wrap"B>><"col-sm-12 col-md-4"f>>t<"row"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',buttons:[{extend:"excel",text:"excel",ttleAtter:"Exportar a Excel",className:"btn btn-danger excelButton",exportOptions:{modifier:{search:"none"}}},
{extend:"pdf",text:"PDF",ttleAtter:"Exportar a PDF",className:"btn btn-primary",exportOptions:{modifier:{search:"none"}}},{extend:"csv",text:"CSV",ttleAtter:"Exportar a CSV",className:"btn btn-warning",exportOptions:{modifier:{search:"none"}}}]})}
function fntVer(c){let b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b.open("GET",base_url+"clientes/getCte/"+c,!0);b.send();b.onreadystatechange=function(){if(4===b.readyState&&200===b.status){let a=JSON.parse(b.responseText);if(a.status){let b=1===a.data.status?'<span class="bagde badge-success">Activo</option>':'<span class="badge badge-danger">Inactivo</option>';document.getElementById("verIdentificacion").innerHTML=a.data.identificacion;document.getElementById("verNombre").innerHTML=
a.data.nombres;document.getElementById("verApellido").innerHTML=a.data.apellidos;document.getElementById("verTelefono").innerHTML=a.data.telefono;document.getElementById("verEmail").innerHTML=a.data.email_user;document.getElementById("verNit").innerHTML=a.data.nit;document.getElementById("verNombreFiscal").innerHTML=a.data.nombrefiscal;document.getElementById("verDirFiscal").innerHTML=a.data.direccionfiscal;document.getElementById("verEstado").innerHTML=b;document.getElementById("verFechReg").innerHTML=
a.data.fechaRegistro;$("#modalVerCte").modal("show")}else Swal.fire("Error",a.msg,"error")}}}
function fntDel(c){Swal.fire({title:"Eliminar Usuario",text:"Quieres eliminar el Rol?",type:"warning",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:"Si, Eliminar",cancelButtonText:"No, Cancelar",closeOnConfirm:!1,coseOnCancel:!0},function(b){if(b){let a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b="idUsuario="+c;a.open("POST",base_url+"clientes/delCliente/",!0);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.send(b);a.onreadystatechange=
function(){if(4===a.readyState&&200===a.status){let b=JSON.parse(a.responseText);b.status?(Swal.fire("eliminar!",b.msg,"success"),tableClientes.ajax.reload(null,!1)):Swal.fire("Atencio!",b.msg,"error")}}}})}
function fntStatus(c){let b=document.querySelector("#btnStatusRol"+c).value,a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.open("GET",base_url+"clientes/status/?id="+c+"&intStatus="+b,!0);a.send();a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){let b=JSON.parse(a.responseText);b.status?tableClientes.ajax.reload(null,!1):swal.fire("Atencio!",b.msg,"error")}}};