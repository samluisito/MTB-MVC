let tableRoles;document.addEventListener("DOMContentLoaded",function(){tablaRoles()});function tablaRoles(){tableRoles=$("#tableRoles").DataTable({destroy:!0,aServerSide:!0,responsive:!0,language:{url:"https://cdn.datatables.net/plug-ins/1.10.21/i18n/Spanish.json"},ajax:{url:base_url+"roles/getRoles",dataSrc:""},columns:[{data:"idrol"},{data:"nombrerol"},{data:"descripcion"},{data:"status"},{data:"options",searchable:!1}],bProcessing:!0,iDisplayLength:10,order:[[0,"asc"]]})}
function formRol(){let c=document.querySelector("#formRol");c.onsubmit=function(a){a.preventDefault();a=document.querySelector("#idRol").value;var b=document.querySelector("#txtNombre").value;let f=document.querySelector("#txtDescripcion").value;0<a?document.querySelector("#listStatus"):document.querySelector("#listStatus").value=1;if(""===b||""===f)return Swal.fire("atencion","todos los campos son obligatorios.","error"),!1;let d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");
a=base_url+"roles/setRol";b=new FormData(c);d.open("POST",a,!0);d.send(b);d.onreadystatechange=function(){if(4===d.readyState&&200===d.status){let b=JSON.parse(d.responseText);b.status?($("#modalFormRol").modal("hide"),c.reset(),Swal.fire("Roles de Ususario",b.msg,"success"),tableRoles.ajax.reload(null,!1)):Swal.fire("Error",b.msg,"error")}}}}
function nvoRol(c){document.querySelector("#idRol").value="";document.querySelector(".modal-header").classList.replace("headerUpdate","headerRegister");document.querySelector("#btnActionForm").classList.replace("btn-info","btn-primary");document.querySelector("#titleModal").innerHTML="Nuevo Rol";document.querySelector("#formRol").reset();document.querySelector("#listStatusLabel").hidden=!0;document.querySelector("#listStatus").hidden=!0;document.querySelector("#formRol").reset();$("#modalFormRol").modal("show");
formRol()}
function fntEdit(c){document.querySelector("#titleModal").innerHTML="Editar Rol";document.querySelector(".modal-header").classList.replace("headerRegister","headerUpdate");document.querySelector("#btnActionForm").classList.replace("btn-primary","btn-info");document.querySelector("#listStatusLabel").hidden=!1;document.querySelector("#listStatus").hidden=!1;let a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.open("GET",base_url+"roles/getRol/"+c,!0);a.send();a.onreadystatechange=
function(){if(4===a.readyState&&200===a.status){let b=JSON.parse(a.responseText);b.status?(document.querySelector("#idRol").value=b.data.idrol,document.querySelector("#txtNombre").value=b.data.nombrerol,document.querySelector("#txtDescripcion").value=b.data.descripcion,document.querySelector("#listStatus").value=b.data.status,$("#modalFormRol").modal("show"),formRol()):Swal.fire("Error",b.msg,"error")}}}
function fntDel(c){Swal.fire({title:"Eliminar rol",text:"Quieres eliminar el Rol?",type:"warning",showCancelButton:!0,showConfirmButton:!0,cancelButtonText:"No, Cancelar",closeOnConfirm:!1,coseOnCancel:!0},function(a){if(a){document.querySelector("#idRol").value=objData.data.idrol;let b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a="idrol="+c;b.open("POST",base_url+"roles/delRol/",!0);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send(a);
b.onreadystatechange=function(){if(4===b.readyState&&200===b.status){let a=JSON.parse(b.responseText);a.status?(Swal.fire("eliminar!",a.msg,"success"),tableRoles.ajax.reload(null,!1),nvoRol()):Swal.fire("Atencio!",a.msg,"error")}}}})}
function fntStatus(c){let a=document.querySelector("#btnStatusRol"+c).value,b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b.open("GET",base_url+"roles/statusRol/?idRol="+c+"&intStatus="+a,!0);b.send();b.onreadystatechange=function(){if(4===b.readyState&&200===b.status){let a=JSON.parse(b.responseText);a.status?tableRoles.ajax.reload(null,!1):Swal.fire("Atencio!",a.msg,"error")}}}let tablePermisos;
function fntPermisos(c){tablePermisos=$("#tablePermisos").DataTable({destroy:!0,responsive:!0,paging:!1,iDisplayLength:25,ordering:!0,order:[[0,"desc"]],search:!1,searching:!1,Processing:!0,info:!1,scrollX:"200px",language:{url:"https://cdn.datatables.net/plug-ins/1.10.21/i18n/Spanish.json"},ajax:{url:base_url+"roles/getpermisos/?idrol="+c,dataSrc:""},columns:[{data:"idmodulo",visible:!1,searchable:!1,all:!0},{data:"rolid",visible:!1,searchable:!1,all:!0},{data:"moduloid",visible:!1,searchable:!1,
all:!0},{data:"titulo"},{data:"ver"},{data:"crear"},{data:"actualizar"},{data:"eliminar"}]});$("#modalPermisos").modal("show")}
function fntActionPermiso(c,a){let b=c+a,f=document.querySelector("#"+b).value,d;0===f?d=1:1===f&&(d=0);let e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");c="idPermiso="+a+"&tpoPermiso="+c+"&estado="+d;e.open("POST",base_url+"roles/setPermiso",!0);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.send(c);e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){let a=JSON.parse(e.responseText);a.status?document.querySelector("#"+
b).value=a.value:Swal.fire("Error",a.msg,"error")}}};