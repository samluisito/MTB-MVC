let tableRegiones;document.addEventListener("DOMContentLoaded",function(){document.querySelector("#formConfiguracion")&&(formConfiguracion(),allFotoConfiguracion());document.querySelector("#formTiposDePago")&&formTiposDePago()});
function allFotoConfiguracion(){document.querySelectorAll(".fotoinput").forEach(function(c){let a=c.id,b=document.querySelector("#"+a);b.onchange=function(c){c.preventDefault();var e=document.querySelector("#"+a).value;let d=document.querySelector("#"+a).files;c=window.URL||window.webkitURL;let f=document.querySelector("#form_alert"+a);if(""!==e){e=d[0].type;if("image/jpeg"!==e&&"image/jpg"!==e&&"image/png"!==e)return f.innerHTML='<p class="errorArchivo">El archivo no es v\u00e1lido.</p>',document.querySelector("#img"+
a)&&document.querySelector("#img"+a).remove(),b.value="",!1;f.innerHTML="";document.querySelector("#img"+a)&&document.querySelector("#img"+a).remove();c=c.createObjectURL(this.files[0]);document.querySelector(".prevPhoto-"+a+"  div").innerHTML="<img id='img"+a+"' src="+c+" requiered=''>"}else alert("No selecciono foto"),document.querySelector("#img"+a)&&document.querySelector("#img"+a).remove();document.querySelector("#foto_remove_"+a).value=1};document.querySelector(".delPhoto")&&(document.querySelector(".delPhoto").onclick=
function(b){document.querySelector("#foto_remove_"+a).value=1;document.querySelector("#"+a).value="";document.querySelector(".delPhoto").classList.add("notBlock");document.querySelector("#img"+a)&&document.querySelector("#img"+a).remove()})})}
function formConfiguracion(){let c=document.querySelector("#formConfiguracion");c.onsubmit=function(a){a.preventDefault();let b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a=base_url+"configuracion/setConfiguracion";let d=new FormData(c);b.open("POST",a,!0);b.send(d);b.onreadystatechange=function(){if(4===b.readyState&&200===b.status){let a=JSON.parse(b.responseText);a.status?Swal.fire({icon:"success",title:"Configuracion General",text:a.msg,timer:1500,timerProgressBar:!0,
showConfirmButton:!1}).then(a=>{a.dismiss===Swal.DismissReason.timer&&location.reload()}):Swal.fire("Error",a.msg,"error")}}}}function fntCheckTP(c){var a="#"+c;console.log(a);a=document.querySelector(a).value;document.querySelector("#"+c).value=0===a?1:0}
function formTiposDePago(){let c=document.querySelector("#formTiposDePago");c.onsubmit=function(a){a.preventDefault();let b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a=base_url+"configuracion/setTiposDePago";let d=new FormData(c);b.open("POST",a,!0);b.send(d);b.onreadystatechange=function(){if(4===b.readyState&&200===b.status){let a=JSON.parse(b.responseText);a.status?Swal.fire({title:"Configuracion General",text:a.msg,type:"success",showCancelButton:!1,showConfirmButton:!0,
confirmButtonText:"OK",closeOnConfirm:!1,coseOnCancel:!1},function(a){a&&location.reload()}):Swal.fire("Error",a.msg,"error")}}}}
tableRegiones=$("#tableRegiones").DataTable({destroy:!0,stateSave:!0,responsive:!0,search:!0,searching:!0,iDisplayLength:25,order:[],dom:'<"row"<"col-sm-12 col-md-4"l><"col-sm-12 col-md-4"<"dt-buttons btn-group flex-wrap"B>><"col-sm-12 col-md-4"f>>t<"row"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',language:{sProcessing:"Procesando...",sLengthMenu:"Mostrar _MENU_ registros",sZeroRecords:"Co\u00f1o Panita, no tengo nada que mostrarte",sEmptyTable:"La tabla esta vacia, cargale datos ",sInfo:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
sInfoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",sInfoFiltered:"(filtrado de un total de _MAX_ registros)",sInfoPostFix:"",sSearch:"Buscar:",sUrl:"",sInfoThousands:",",sLoadingRecords:"Espera... Ten Paciencia... Falta poco...",oPaginate:{sFirst:"Primero",sLast:"\u00daltimo",sNext:"Siguiente",sPrevious:"Anterior"},oAria:{sSortAscending:": Activar para ordenar la columna de manera ascendente",sSortDescending:": Activar para ordenar la columna de manera descendente"},buttons:{copy:"Copiar",
colvis:"Visibilidad"}},ajax:{url:base_url+"configuracion/getRegionesList",dataSrc:""},columns:[{data:"idregion"},{data:"region"},{data:"idioma"},{data:"moneda"},{data:"zona_horaria"},{data:"options"}],columnDefs:[{targets:[0],className:"text-rigth align-middle",orderable:!1,searchable:!1,visible:!0},{targets:[1],className:"text-rigth align-middle",orderable:!1,searchable:!0},{targets:[2],className:"text-rigth align-middle",orderable:!1,searchable:!1,visible:!0},{targets:[3],className:"text-center align-middle",
orderable:!1},{targets:[4],className:"text-center align-middle",orderable:!1},{targets:[5],className:"text-center align-middle",orderable:!1,searchable:!1}],buttons:[{extend:"csv",text:"Exportar a CSV",ttleAtter:"Exportar a CSV",className:"btn btn-warning",exportOptions:{modifier:{search:"none"}}}]});
function nvaRegion(){document.querySelector("#idRegion").value="";document.querySelector(".modal-title").innerHTML="Nueva Region";document.querySelector(".modal-header").classList.replace("headerUpdate","headerRegister");document.querySelector(".btnDuplicar").classList.add("notBlock");document.querySelector("#btnActionForm").classList.replace("btn-info","btn-primary");document.querySelector("#btnText").innerHTML="Guardar";document.querySelector("#pagina_prev").innerHTML="";document.querySelector("#pagina_poss").innerHTML=
"";document.querySelector("#pagina_prox").innerHTML="";formRegion()}
function fntEdit(c){fetch(base_url+"configuracion/getRegion/"+c).then(a=>a.json()).then(a=>{a.status?(document.querySelector("#formRegion").reset(),document.querySelector(".modal-title").innerHTML="Editar Region",document.querySelector(".modal-header").classList.replace("headerRegister","headerUpdate"),document.querySelector(".btnDuplicar").classList.remove("notBlock"),document.querySelector("#btnActionForm").classList.replace("btn-primary","btn-info"),document.querySelector("#btnText").innerHTML=
"Guardar",a=a.data,document.querySelector("#idRegion").value=a.idregion,document.querySelector("#txtNombre").value=a.region,document.querySelector("#txtAbrev").value=a.region_abrev,document.querySelector("#txtIdioma").value=a.idioma,document.querySelector("#txtTimeZone").value=a.timezone,document.querySelector("#txtMoneda").value=a.moneda,document.querySelector("#txtFormatoMoneda").value=a.moneda_formato,document.querySelector("#txtSimboloMoneda").value=a.moneda_simbolo,document.querySelector("#txtSPM").value=
a.moneda_separador_miles,document.querySelector("#txtSPD").value=a.moneda_separador_decimales,document.querySelector("#txtUTC").value=a.zona_horaria,document.querySelector("#txtFormatoFecha").value=a.fecha_formato,document.querySelector("#pagina_prev").innerHTML=0===a.prev?"":'<button class="page-item page-link  pull-left" onClick="fntEdit('+a.prev+')" style="margin: auto;"><i class="fa fa-arrow-left" aria-hidden="true"></i></button>',document.querySelector("#pagina_prox").innerHTML=0===a.prox?"":
'<button class="page-item page-link pull-right" onClick="fntEdit('+a.prox+')" style="margin: auto;"><i class="fa fa-arrow-right" aria-hidden="true"></i></button>',document.querySelector("#pagina_poss").innerHTML='<span class="text-primary" >'+a.posicion+"</span>",formRegion()):Swal.fire("Error",a.msg,"error")}).catch(a=>console.error(a))}
function formRegion(){$("#modalFormRegion").modal("show");let c=document.querySelector("#formRegion");c.onsubmit=function(a){a.preventDefault();a=new FormData(c);fetch(base_url+"productos/setRegion",{method:"POST",body:a}).then(a=>a.json()).then(a=>{a.status?(Swal.fire("Regiones",a.msg,"success"),fntEdit(a.idregion),tableRegiones.ajax.reload(null,!1)):Swal.fire("Error",a.msg,"error")})}}
function fntVer(c){fetch(base_url+"configuracion/getRegion/"+c).then(a=>a.json()).then(a=>{if(a.status){var b=a.data;document.querySelector("#celCodigo").innerHTML=b.codigo;document.querySelector("#celNombre").innerHTML=b.nombre;document.querySelector("#celPrecio").innerHTML=parseFloat(b.precio*dolarHoy).toFixed(2);document.querySelector("#celStock").innerHTML=b.stock;document.querySelector("#celCategoria").innerHTML=b.categoria;document.querySelector("#celProveedor").innerHTML=b.proveedor;document.querySelector("#celDescripcion").innerHTML=
b.descripcion;a=base_url+"tienda/producto/"+b.ruta;document.querySelector("#opcionesCompartir2").innerHTML=`
          <a class="btn btn-outline-primary m-1" href="#" onclick="window.open('http://www.facebook.com/sharer/sharer.php?display=popup&u=${a}', 'facebook-share-dialog', 'toolbar=0, status=0, width = 400, height = 550'); return false;" data-tooltip="Facebook"><i class="fab fa-facebook"></i></a>
          <a class="btn btn-outline-primary m-1" href="#" onclick="window.open('https://twitter.com/intent/tweet?text=${b.nombre}%0A&url=${a}','twitter-share-dialog', 'toolbar=0, status=0,width=650,height=400,modal=yes');return false;"   data-tooltip="Twitter"><i class="fab fa-twitter"></i></a> 
          <a class="btn btn-outline-primary m-1" href="#" onclick="window.open('https://wa.me/?url=${b.nombre}&text=%0A${a}','WhatsApp-share-dialog', 'toolbar=0, status=0,width = 800,height = 1000,modal=yes');return false;"  data-tooltip="WhatsApp"><i class="fab fa-whatsapp" aria-hidden="true"></i></a> 
          <a class="btn btn-outline-primary m-1" href="#" onclick="window.open('https://t.me/share/url?url=${b.nombre}%0A${a}&text=${b.nombre}&to=','telegram-share-dialog', 'toolbar=0, status=0,width = 500,height = 500,modal=yes');return false;" data-tooltip="Telegram"><i class="fab fa-telegram" aria-hidden="true"></i></a>`;document.querySelector("#pagina_prev2").innerHTML=0===b.prev?"":'<button class="page-item page-link  pull-left" onClick="fntVer('+b.prev+')" style="margin: auto;"><i class="fa fa-arrow-left" aria-hidden="true"></i></button>';
document.querySelector("#pagina_prox2").innerHTML=0===b.prox?"":'<button class="page-item page-link pull-right" onClick="fntVer('+b.prox+')" style="margin: auto;"><i class="fa fa-arrow-right" aria-hidden="true"></i></button>';document.querySelector("#pagina_poss2").innerHTML='<span class="text-primary" >'+b.posicion+"</span>";a="";if(0<b.images.length){b=b.images;for(let c=0;c<b.length;c++)a+=`<div class="prod-pic-rel">
                           <a href="${b[c].url_image}" class="prod-scale-img thumb preview-thumb image-popup">
                              <img src="${b[c].url_thumb}" class="img-fluid " alt="work-thumbnail"> 
                           </a>
                        </div>
                  `}document.querySelector("#celFotos").innerHTML=a;ligthbbox_reload();$("#modalVerProducto").modal("show")}else Swal.fire("Error",a.msg,"error")})};